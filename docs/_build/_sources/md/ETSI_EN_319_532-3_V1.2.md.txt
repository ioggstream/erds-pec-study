### Electronic Signatures and Infrastructures (ESI);

### Registered Electronic Mail (REM) Services;

### Part 3: Formats

#### EUROPEAN STANDARD


 Reference REN/ESI-0019532-3v121

 Keywords e-delivery services, registered e-delivery services, registered electronic mail

 ETSI

 650 Route des Lucioles F-06921 Sophia Antipolis Cedex FRANCE

 Tel.: +33 4 92 94 42 00 Fax: +33 4 93 65 47 16 Siret N° 348 623 562 00017 NAF 742 C Association à but non lucratif enregistrée à la Sous-Préfecture de Grasse (06) N° 7803/88

 Important notice

 The present document can be downloaded from: http://www.etsi.org/standards-search

The present document may be made available in electronic versions and/or in print. The content of any electronic and/or print versions of the present document shall not be modified without the prior written authorization of ETSI. In case of any existing or perceived difference in contents between such versions and/or in print, the prevailing version of an ETSI deliverable is the one made publicly available in PDF format at [http://www.etsi.org/deliver.](http://www.etsi.org/deliver.)

 Users of the present document should be aware that the document may be subject to revision or change of status. Information on the current status of this and other ETSI documents is available at https://portal.etsi.org/TB/ETSIDeliverableStatus.aspx

 If you find errors in the present document, please send your comment to one of the following services: https://portal.etsi.org/People/CommiteeSupportStaff.aspx

 Copyright Notification

 No part may be reproduced or utilized in any form or by any means, electronic or mechanical, including photocopying and microfilm except as authorized by written permission of ETSI. The content of the PDF version shall not be modified without the written authorization of ETSI. The copyright and the foregoing restriction extend to reproduction in all media.

 © ETSI 2019. All rights reserved.

 DECTTM, PLUGTESTSTM, UMTSTM^ and the ETSI logo are trademarks of ETSI registered for the benefit of its Members. 3GPPTM^ and LTETM^ are trademarks of ETSI registered for the benefit of its Members and of the 3GPP Organizational Partners. oneM2M™ logo is a trademark of ETSI registered for the benefit of its Members and of the oneM2M Partners. GSM®^ and the GSM logo are trademarks registered and owned by the GSM Association.


## Contents

Intellectual Property Rights ................................................................................................................................4

Foreword.............................................................................................................................................................4

Modal verbs terminology....................................................................................................................................4

Introduction ........................................................................................................................................................5

1 Scope ........................................................................................................................................................6

2 References ................................................................................................................................................6
2.1 Normative references ......................................................................................................................................... 6
2.2 Informative references ........................................................................................................................................ 7

3 Definition of terms, abbreviations and terminology.................................................................................7
3.1 Terms.................................................................................................................................................................. 7
3.2 Abbreviations ..................................................................................................................................................... 7
3.3 Terminology ....................................................................................................................................................... 8

4 Message formats .......................................................................................................................................8
4.1 Introduction ........................................................................................................................................................ 8
4.2 Internet Message Format in the REM services ................................................................................................... 8
4.3 REM message Structure Definition................................................................................................................ 10

5 REMS identification formats ...............................................................................................................15

6 REMS relay metadata formats .............................................................................................................15
6.1 General requirements ....................................................................................................................................... 15
6.2 REM message structure .................................................................................................................................... 16
6.2.1 REMS relay metadata MIME Header Fields .............................................................................................. 16
6.2.2 signed data MIME Header Fields ............................................................................................................... 19
6.2.3 REMS introduction MIME Header Fields-Body ........................................................................................ 19
6.2.3.1 General requirements ............................................................................................................................ 19
6.2.3.2 multipart/alternative: free text subsection Header Fields ...................................................................... 19
6.2.3.3 multipart/alternative: HTML subsection Header Fields ........................................................................ 20
6.2.3.4 Introduction body formats ..................................................................................................................... 20
6.2.4 original message MIME Header Fields ...................................................................................................... 20
6.2.4.1 original message general requirements ................................................................................................. 20
6.2.4.2 original message MIME section Header Fields .................................................................................. 20
6.2.4.3 original message MIME section Body formats ................................................................................... 21
6.2.5 REMS extensions MIME Header Fields ..................................................................................................... 21
6.2.6 ERDS evidence MIME Header Fields ........................................................................................................ 22
6.2.6.1 General requirements ............................................................................................................................ 22
6.2.6.2 Header Fields for XML ERDS evidence usage ..................................................................................... 22
6.2.6.3 Header Fields for PDF ERDS evidence usage ...................................................................................... 23
6.2.7 REMS signature MIME Header Fields-Body ............................................................................................. 23

7 REMS evidence set formats .................................................................................................................24

8 REMS signatures formats ....................................................................................................................24
8.1 General ............................................................................................................................................................. 24
8.2 Signatures individually signing ERDS Evidence ............................................................................................. 25
8.3 Signatures on REM messages .......................................................................................................................... 25

9 Common Service Interface formats ........................................................................................................25
9.1 General requirements ....................................................................................................................................... 25
9.2 Routing information ......................................................................................................................................... 25
9.3 Trust information.............................................................................................................................................. 26
9.4 Capability management .................................................................................................................................... 26

Annex A (informative): REM message examples ................................................................................28

History ..............................................................................................................................................................35


## Intellectual Property Rights

Essential patents

IPRs essential or potentially essential to normative deliverables may have been declared to ETSI. The information pertaining to these essential IPRs, if any, is publicly available for ETSI members and non-members, and can be found in ETSI SR 000 314: "Intellectual Property Rights (IPRs); Essential, or potentially Essential, IPRs notified to ETSI in respect of ETSI standards", which is available from the ETSI Secretariat. Latest updates are available on the ETSI Web server (https://ipr.etsi.org/).

Pursuant to the ETSI IPR Policy, no investigation, including IPR searches, has been carried out by ETSI. No guarantee can be given as to the existence of other IPRs not referenced in ETSI SR 000 314 (or the updates on the ETSI Web server) which are, or may be, or may become, essential to the present document.

Trademarks

The present document may include trademarks and/or tradenames which are asserted and/or registered by their owners. ETSI claims no ownership of these except for any which are indicated as being the property of ETSI, and conveys no right to use or reproduce any trademark and/or tradename. Mention of those trademarks in the present document does not constitute an endorsement by ETSI of products, services or organizations associated with those trademarks.

## Foreword

This European Standard (EN) has been produced by ETSI Technical Committee Electronic Signatures and Infrastructures (ESI).

The present document is part 3 of a multi-part deliverable. Full details of the entire series can be found in part 1 [10].

###### National transposition dates

 Date of adoption of this EN: 9 April 2019

 Date of latest announcement of this EN (doa): 31 July 2019

 Date of latest publication of new National Standard or endorsement of this EN (dop/e): 31 January 2020

 Date of withdrawal of any conflicting National Standard (dow): 31 January 2020

## Modal verbs terminology

In the present document "shall", "shall not", "should", "should not", "may", "need not", "will", "will not", "can" and "cannot" are to be interpreted as described in clause 3.2 of the ETSI Drafting Rules (Verbal forms for the expression of provisions).

"must" and "must not" are NOT allowed in ETSI deliverables except when used in direct citation.


## Introduction

Registered Electronic Mail (REM) is a particular instance of an "Electronic Registered Delivery Service" (ERDS). Standard email, used as backbone, makes interoperability smooth and increases usability. At the same time, the application of additional security mechanisms ensures integrity, confidentiality and non-repudiation (of submission, consignment, handover, etc.), and protects against risk of loss, theft, damage and any illegitimate modification.

The present document aims to cover the common and worldwide-recognized requirements to address electronic registered delivery in a secure and reliable way. Particular attention is paid to the Regulation (EU) No 910/2014 [i.5]. However, the legal effects are outside the scope of the present document.


## 1 Scope

The present document specifies the formats for messages that are produced and handled by a Registered Electronic Mail (REM) service according to the concepts and semantic defined in ETSI EN 319 522 parts 1 [7] and 2 [8] and ETSI EN 319 532 parts 1 [10] and 2 [11]. More specifically, the present document:

 a) Specifies how the general ERDS concepts like user content and metadata are identified and mapped in the standard email structure.

 b) Specifies how the aforementioned concepts are mapped in the REM service messaging structures.

 c) Specifies how the ERDS evidence set is plugged inside the REM service messaging structures.

 d) Specifies additional mechanisms like digital signature and other security controls.

## 2 References

#### 2.1 Normative references

References are either specific (identified by date of publication and/or edition number or version number) or non-specific. For specific references, only the cited version applies. For non-specific references, the latest version of the referenced document (including any amendments) applies.

Referenced documents which are not found to be publicly available in the expected location might be found at https://docbox.etsi.org/Reference/.

 NOTE: While any hyperlinks included in this clause were valid at the time of publication, ETSI cannot guarantee their long term validity.

The following referenced documents are necessary for the application of the present document.

 [1] IETF RFC 8118: "The application/pdf Media Type".

 [2] IETF RFC 2183: "Communicating Presentation Information in Internet Messages: The ContentDisposition Header Field".

 [3] IETF RFC 5751: "Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Message Specification".

 [4] IETF RFC 5322: "Internet Message Format".

 [5] IETF RFC 2854: "The 'text/html' Media Type".

 [6] IETF RFC 7303: "XML Media Types".

 [7] ETSI EN 319 522-1: "Electronic Signatures and Infrastructures (ESI); Electronic Registered Delivery Services; Part 1: Framework and Architecture".

 [8] ETSI EN 319 522-2: "Electronic Signatures and Infrastructures (ESI); Electronic Registered Delivery Services; Part 2: Semantic Contents".

 [9] ETSI EN 319 522-3: "Electronic Signatures and Infrastructures (ESI); Electronic Registered Delivery Services; Part 3: Formats".

 [10] ETSI EN 319 532-1: "Electronic Signatures and Infrastructures (ESI); Registered Electronic Mail (REM) Services; Part 1: Framework and Architecture".

 [11] ETSI EN 319 532-2: "Electronic Signatures and Infrastructures (ESI); Registered Electronic Mail (REM) Services; Part 2: Semantic contents".

 [12] IETF RFC 2045: "Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies".


 [13] IETF RFC 2046: "Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types".

 [14] IETF RFC 5321: "Simple Mail Transfer Protocol".

 [15] ETSI TS 119 612: "Electronic Signatures and Infrastructures (ESI); Trusted Lists".

#### 2.2 Informative references

References are either specific (identified by date of publication and/or edition number or version number) or non-specific. For specific references, only the cited version applies. For non-specific references, the latest version of the referenced document (including any amendments) applies.

 NOTE: While any hyperlinks included in this clause were valid at the time of publication, ETSI cannot guarantee their long term validity.

The following referenced documents are not necessary for the application of the present document but they assist the user with regard to a particular subject area.

 [i.1] ETSI EN 319 532-4: "Electronic Signatures and Infrastructures (ESI); Registered Electronic Mail (REM) Services; Part 4: Interoperability profiles".

 [i.2] ETSI TS 119 312: "Electronic Signatures and Infrastructures (ESI); Cryptographic Suites".

 [i.3] IETF RFC 6648: "Deprecating the "X-" Prefix and Similar Constructs in Application Protocols".

 [i.4] ETSI EN 319 521: "Electronic Signatures and Infrastructures (ESI); Policy and security requirements for Electronic Registered Delivery Service Providers".

 [i.5] Regulation (EU) No 910/2014 of the European Parliament and of the Council of 23 July 2014 on electronic identification and trust services for electronic transactions in the internal market and repealing Directive 1999/93/EC.

 [i.6] ETSI EN 319 122-1: "Electronic Signatures and Infrastructures (ESI); CAdES digital signatures; Part 1: Building blocks and CAdES baseline signatures".

 [i.7] ETSI EN 319 142-1: "Electronic Signatures and Infrastructures (ESI); PAdES digital signatures; Part 1: Building blocks and PAdES baseline signatures".

 [i.8] ETSI EN 319 522-4-3: "Electronic Signatures and Infrastructures (ESI); Electronic Registered Delivery Services; Part 4: Bindings; Sub-part 3: Capability/requirements bindings".

 [i.9] IETF RFC 6931: "Additional XML Security Uniform Resource Identifiers (URIs)".

## 3 Definition of terms, abbreviations and terminology

#### 3.1 Terms

For the purposes of the present document, the terms given in ETSI EN 319 532-1 [10] apply.

#### 3.2 Abbreviations

For the purposes of the present document, the abbreviations given in ETSI EN 319 532-1 [10] apply.


#### 3.3 Terminology

 Since Registered Electronic Mail Services are specific types of Electronic Registered Delivery Services, the present document uses the terms and definitions from ETSI EN 319 521 [i.4] and ETSI EN 319 522 [7], [8] and [9].

 ETSI EN 319 532-2 [11], clause 4.1 specifies the usage of prefixes ERD versus REM or ERDS versus REMS for naming concepts and/or structures.

 The naming convention used in the present document is that constructs whose content is completely generated by the REMS is prefixed with "ERDS" or "REMS", while constructs whose content includes user generated data is prefixed with "ERD" or "REM".

## 4 Message formats

#### 4.1 Introduction

 The present clause defines and explains how metadata and contents are formatted in REM messages. Schemas and format definitions of ETSI EN 319 522-3 [9] are reviewed in the REM perspective. Further implicit references are to ETSI EN 319 532-2 [11], clause 4 describing the contents.

 To define the formats involved in communication exchanges in the REM (and so email) scope, it is necessary to individuate and distinguish fundamental parts like user content and metadata components.

 As outlined in ETSI EN 319 522-2 [8], clause 4, the user content is the content generated or provided by the sender, that is intended to be delivered to a recipient. Metadata related to the user content, e.g. in the case of submission, relay or handover events, are provided for purposes of handling and processing a message, e.g. message identification, identification of sender/recipient(s), or also for service capabilities discovery.

 Annex A describes how these meaningful concepts have been mapped first in email and later in REMSs provision context starting with a description example for a graphical individuation of the components. Next clauses describe how ERD concepts are mapped on REM following with the format specifications.

#### 4.2 Internet Message Format in the REM services

 In the context of email and REM services provision the concepts like user content and metadata have a correspondence with the elements of Mail Object as defined in IETF RFC 5321 [14], clause 2.3.1 and with the definitions contained in ETSI EN 319 522-1 [7], clause 3.1, ETSI EN 319 522-2 [8], clause 4, and ETSI EN 319 532-2 [11], clause 4.

 Table 1 illustrates the root of terms (if any), used in the next clauses, and the intended meaning in the REM context.

 Table 1: ERD to REM terms mapping

Root definition (from ETSI EN 319 522-2 [8])

 REM equivalent definition

 Detailed definition

 user content user content This is the body of the Mail Object as defined in IETF RFC 5321 [14], clause 2.3.1 (note 1). It is generated by the sender under the sender's technical/legal responsibility. See also ETSI EN 319 532-2 [11], clause 4. submission metadata submission metadata This is the header section of the Mail Object as defined in IETF RFC 5321 [14], clause 2.3.1. See Figure 1, Figure 4 and also definitions in ETSI EN 319 532-2 [11], clause 4. original message This is composed of header + body as defined in IETF RFC 5321 [14], clause 2.3.1. It is generated by the sender's ERD user agent or under the sender's technical/legal responsibility (and outside the responsibility of the service), which may be eventually digitally signed by the sender (note 1). See Figure 1, Figure 4 and also definitions in ETSI EN 319 532-2 [11], clause 4.


 Root definition (from ETSI EN 319 522-2 [8])

 REM equivalent definition

 Detailed definition

 ERDS relay metadata REMS relay metadata This is the header section (as defined in IETF RFC 5321 [14]) of the REM message. Also the REMS introduction is considered part of the REMS relay metadata. See from Figure 1 to Figure 4 and also definitions in ETSI EN 319 532-2 [11], clause 4. ERDS handover metadata

 REMS handover metadata

The same of mapping of REMS relay metadata with the semantic defined in ETSI EN 319 532-2 [11], clause 4. ERDS evidence ERDS evidence One of the methods usable to transport the ERDS evidence in REM is an attachment body part (as defined in IETF RFC 2045 [12]) of the REM message. See from Figure 1 to Figure 3 and also definitions in ETSI EN 319 532-2 [11], clause 4. ERDS serviceInfo REMS notification See Figure 3 for the structure of this object and definitions in ETSI EN 319 532-1 [10], clause 3.1. The difference from ERDS serviceInfo is that a REMS notification always contains a reference to the user content. Furthermore, it may optionally carry the relevant evidence. ERD message REM message See from Figure 1 to Figure 4 for all the possible structures in parts (as defined in IETF RFC 2045 [12]). ERD payload REM payload See Figure 4 for the structure of this object and also definition in ETSI EN 319 521 [i.4], clause 3 and ETSI EN 319 522-1 [7], clause 3. ERD dispatch REM dispatch See Figure 1 for the structure of this object and also definition in ETSI EN 319 521 [i.4], clause 3 and ETSI EN 319 522-1 [7], clause 3 and further details in ETSI EN 319 532-2 [11], clause 4. It is a new object (according to the REM message structure) generated by the REM Service enclosing the original message and other contents generated by the REM Service, who is responsible only for part of its contents (it is not responsible for the contents of the original message). transport metadata When the original message is submitted over SMTP, this is the transport information and the closure information conveyed in a typical SMTP session (see Figure A.1). It wraps the original message inside the SMTP transaction and it contains commands and answer information flowing during the client/server communication, as defined in IETF RFC 5321 [14] (note 2). NOTE 1: The term body, in the context of the present document, indicates also a "possibly structured" body part including one or more attachments, according to MIME standard specification, as provided in IETF RFC 2045 [12], clause 2.6. NOTE 2: Further considerations regarding specific protocol elements like transport and closure are out of scope for the present document and are managed in ETSI EN 319 532-4 [i.1], clause 5.3.5 CSI.

 In the email ambit, (that is the basis of REM), the aforementioned concepts apply to the messaging stream.

 Figure A.1 shows an example of where the constructs shown in Table 1 are located along the protocol stream.

 An important feature specific for REM is that exactly the standard wrapping mechanism shown in Figure A.1 is also used to incorporate a digital signature into a REM message structure for getting a signed REM message (see Figure A.2). For example, in case of the REM dispatch, it is used to transport the original message together with the other REM message components as attachments and digital signatures, giving the possibility to make available the entire content in a comprehensible and usable way to all interested parties from the sender's REMS up to the recipient (see Figure A.1).

 See Figure A.2 as an example representing this further step, by showing the encapsulation of the original message in a REM dispatch and, similarly the previous example of Figure A.1, where it is located inside the protocol stream.

 The same wrapping mechanism shall be used for enveloping the remaining objects relevant to the REM messages.

 As the REM message contents are separated from the transport information/closure information parts in the communication stream, the entire set of REM messages as specified in the present document may also be properly transported by other underlying transport protocols.

 NOTE 1: This separation ensures that REM messages are completely unrelated to the underlying protocol stream.

 In fact, the underlying protocol only deals with the transport information and closure information of the stream and the REM message remains unchanged. All the REM logic is defined inside the REM message. This makes REM independent from the particular underlying transport protocol. In addition, as REM messages use this universal and standard enveloping, any standard email client of the initiator and/or the final users can process them.


The transmission of information between the sender's REMS and recipient's REMS typically happens according to the "attached" or "detached" forms. In the first case the original message is conveyed inside a REM dispatch. In the latter, it is transmitted using other means (e.g. by a REM payload). The ERDS evidence related to events occurred during the transfer of this original message is sent separately to the recipient, e.g. by a subsequent REM receipt.

The REM Service could add/modify some header fields to the submission metadata during the enveloping process. Anyway, these changes should be limited to what is proven as essential for the good working of the process and should be fully defined in the specific REM implementation.

 NOTE 2: Update of the Message-ID header field can be one of these changes (if it is not present or it needs to be normalized to a universal recognized identifier format, inside the context of the provided service). In such cases, the original identifier, if specified, is assigned to some new custom header field of the submission metadata and to the REM-UAMessageIdentifier: header field of the REM message. A new regularized and universal unique Message-ID is assigned to the submission metadata.

Furthermore, any of the aforementioned changes (additions/modifications of header fields) shall be clearly indicated to the sender and recipient of the REM dispatch or the REM payload.

 NOTE 3: The "REMS introduction MIME section" descriptive text see clause 6.2.3.4 is one of the places where the REMS can put such an indication. Alternatively, the contract with the users represents another place where the REMS can indicate this systematic practice.

#### 4.3 REM message Structure Definition

This clause specifies the structure of a REM message based on the MIME format (see IETF RFC 2045 [12]). A REM message does not exist as a self-standing object, since it always appears in the context of either a REM dispatch, a REMS receipt, a REMS notification or a REM payload.

A REM message may flow between different REMSs, and from a REMS to ERD user agents, as defined in ETSI EN 319 532-1 [10]. It is out of scope of the present document to define how the generic REM message is tailored to the specific mode of operation and interface it flows through.

See the description preceding Figure A.3 for examples of REM message components.

A REM message shall be structured as a message header section containing the header fields followed by a message body composed of several body parts as defined in MIME (IETF RFC 2045 [12]). The message body shall take the form of multipart signed/mixed/alternative MIME sections, in which every MIME-body-part is structured as defined in Figure A.3. This multipart/mixed MIME message shall constitute the signed MIME-body-part of a multipart/signed S/MIME message. The S/MIME signature contained in the last MIME part of the REM message shall therefore be the digital signature of the REMS over the rest of the MIME parts that appear in the REM message.

See Figure A.3 as an example representing this generic structure with all its elements. The different types of REM messages are built as indicated in Table 1 of ETSI EN 319 532-2 [11], clause 4.1, which in turn is derived from Table 1 of ETSI EN 319 522-2 [8], clause 4.

The REM dispatch shall be structured as in Figure 1.

The REMS receipt shall be structured as in Figure 2.

The REMS notification shall be structured as in Figure 3 and shall be generated by REMS according to the flow requirements of ETSI EN 319 532-1 [10], clause 4 and ETSI EN 319 532-2 [11], clause 4.

The REM payload shall be structured as in Figure 4.

They are built starting from the ERD message structure, defined in Table 1 of ETSI EN 319 522-2 [8], clause 4, with the emphasis of REM specific aspects and peculiarities.

The cardinality numbers present in the boxes shall indicate the number of occurrences of any MIME part:

- 0..1 indicates an optional part;

- 0..N indicates an optional part that may occur any number of times;

- Parts not otherwise indicated by cardinality numbers or remarked for clarity with 1 shall occur exactly once.


REM dispatch structure

 Header

 MIME header fields profiled for a multipart/signed MIME message (see clause 6.2.1) [REMS relay metadata 1 plus optionally REMS handover metadata 0..1]

 Body (signed data MIME section)

 Header

 MIME part header fields profiled for a multipart/mixed message (see clause 6.2.2) [REMS relay metadata]

 Body

 REMS introduction

 MIME section [REMS relay metadata]

 1

 Header

 MIME part header fields profiled for a multipart/alternative MIME content (see clause 6.2.3)

 Body

 Plain text introduction

 Header

 MIME part header fields profiled for text/plain (see clause 6.2.3.2)

 Body

(^) A message created by the REMS, to be displayed automatically upon display of the REM message. Text may contain information for the user (see clause 6.2.3.4) HTML introduction Header MIME part header fields profiled for text/html (see clause 6.2.3.3) Body A message created by the REMS, to be displayed automatically upon display of the REM message. HTML may contain URIs and other information for the user (see clause 6.2.3.4) original messageMIME section 1 Header MIME part header fields profiled for an enveloped message/rfc822 message (see clause 6.2.4.2) Body (^) Header and Body of a self-contained IETF RFC 5322 [4] message as submitted by the sender: the submission metadata that becomes part of the REMS relay metadata and the user content (see clause 6.2.4.3) REMS Extensions MIME section 0..N Header MIME part header fields profiled for extensions, e.g. application/xml (see clause 6.2.5) Body Attachment to be used by possible extensions ERDS evidenceMIME section 1..N Header MIME part header fields profiled for an application/xml or application/pdf (see clause 6.2.6) Body ERDS evidence as required by the specific content-type REMSsignature Header MIME part header fields profiled to S/MIME application/pkcs7-signature signature on the whole REM message (see clause 6.2.7) Body S/MIME digital signature generated by the REMS covering the whole structure Figure 1: REM dispatch structure


REMS receipt structure

 H

 eader

(^) MIME header fields profiled for a multipart/signed MIME message (see clause 6.2.1) [REMS relay metadata 1 plus optionally REMS handover metadata 0..1] Body (signed data MIME section) Header MIME part header fields profiled for a multipart/mixed message (see clause 6.2.2) [REMS relay metadata] Body REMS introduction MIME section [REMS relay metadata] 1 Header MIME part header fields profiled for a multipart/alternative MIME content (see clause 6.2.3) Body Plain text introduction Header MIME part header fields profiled for text/plain (see clause 6.2.3.2) Body A message created by the REMS, to be displayed automatically upon display of the REM message. Text may contain information for the user (see clause 6.2.3.4) HTML introduction Header MIME part header fields profiled for text/html (see clause 6.2.3.3) Body A message created by the REMS, to be displayed automatically upon display of the REM message. HTML may contain URIs and other information for the user (see clause 6.2.3.4) REMS Extensions MIME section 0..N Header MIME part header fields profiled for extensions, e.g. application/xml (see clause 6.2.5) Body Attachment to be used by possible extensions ERDS evidenceMIME section 1..N Header MIME part header fields profiled for an application/xml or application/pdf (see clause 6.2.6) Body ERDS evidence as required by the specific content-type REMSsignature Header MIME part header fields profiled to S/MIME application/pkcs7-signature signature on the whole REM message (see clause 6.2.7) Body S/MIME digital signature generated by the REMS covering the whole structure Figure 2: REMS receipt structure


REMS notification structure

 Header

 MIME header fields profiled for a multipart/signed MIME message (see clause 6.2.1) [REMS relay metadata 1 plus optionally REMS handover metadata 0..1]

 Body (signed data MIME section)

 Header

 MIME part header fields profiled for a multipart/mixed message (see clause 6.2.2) [REMS relay metadata]

 Body

 REMS introduction

 MIME section [REMS relay metadata]

 1

 Header

 MIME part header fields profiled for a multipart/alternative MIME content (see clause 6.2.3)

 Body

 Plain text introduction

 Header

 MIME part header fields profiled for text/plain (see clause 6.2.3.2)

 Body

 A message created by the REMS, to be displayed automatically upon display of the REM message. Text may contain URIs (pointer to a repository from where the original message may be retrieved) and other information for the user (see clause 6.2.3.4)

 HTML introduction

 Header

 MIME part header fields profiled for text/html (see clause 6.2.3.3)

 Body

 A message created by the REMS, to be displayed automatically upon display of the REM message. HTML may contain URIs and other information for the user (see clause 6.2.3.4)

 REMS Extensions

 MIME section

 0..N

 Header

 MIME part header fields profiled for extensions, e.g. application/xml (see clause 6.2.5)

 Body

 Attachment to be used by possible extensions

 ERDS evidenceMIME section

 0..N

 Header

 MIME part header fields profiled for an application/xml or application/pdf (see clause 6.2.6)

 Body

 ERDS evidence as required by the specific content-type

 REMS signature

 Header

 MIME part header fields profiled to S/MIME application/pkcs7-signature signature on the whole REM message (see clause 6.2.7)

 Body

 S/MIME digital signature generated by the REMS covering the whole structure

 Figure 3: REMS notification structure


 REM payload structure

 Header

 MIME header fields profiled for a multipart/signed MIME message (see clause 6.2.1) [REMS relay metadata 1 plus optionally REMS handover metadata 0..1]

 Body (signed data MIME section)

 Header

 MIME part header fields profiled for a multipart/mixed message (see clause 6.2.2) [REMS relay metadata]

 Body

 REMS introduction

 MIME section [REMS relay metadata]

 1

 Header

 MIME part header fields profiled for a multipart/alternative MIME content (see clause 6.2.3)

 Body

 Plain text introduction

 Header

 MIME part header fields profiled for text/plain (see clause 6.2.3.2)

 Body

(^) A message created by the REMS, to be displayed automatically upon display of the REM message. Text may contain information for the user (see clause 6.2.3.4) HTML introduction Header MIME part header fields profiled for text/html (see clause 6.2.3.3) Body A message created by the REMS, to be displayed automatically upon display of the REM message. HTML may contain URIs and other information for the user (see clause 6.2.3.4) original messageMIME section 1 Header MIME part header fields profiled for an enveloped message/rfc822 message (see clause 6.2.4.2) Body (^) Header and Body of a self-contained IETF RFC 5322 [4] message as submitted by the sender: the submission metadata that becomes part of the REMS relay metadata and the user content (see clause 6.2.4.3) REMS Extensions MIME section 0..N Header MIME part header fields profiled for extensions, e.g. application/xml (see clause 6.2.5) Body Attachment to be used by possible extensions REMS signature Header MIME part header fields profiled to S/MIME application/pkcs7-signature signature on the whole REM message (see clause 6.2.7) Body S/MIME digital signature generated by the REMS covering the whole structure Figure 4: REM payload structure The following clauses aim at further profiling/constraining each header field of this generic message structure. The present document does not impose any constraint on those header fields not listed in the tables in clause 6.


## 5 REMS identification formats

 For REMS identification formats, ETSI EN 319 522-2 [8], clause 5, the identity components defined in Table 6 of ETSI EN 319 522-2 [8], clause 8.1 and the formats defined in ETSI EN 319 522-3 [9], clause 5 shall apply.

 The REMS shall assign each user a unique identifier, as defined in ETSI EN 319 522-2 [8], clause 5.2 in the format of an email address, defined as "addr-spec" in section 3.4.1 of IETF RFC 5322 [4].

 Table 2 of clause 6.1 of the present document defines how the identity components shall be mapped in REM.

## 6 REMS relay metadata formats

#### 6.1 General requirements

 The present clause defines the REMS relay metadata formats. For this purpose ETSI EN 319 532-2 [11], clause 6 shall apply.

 The composition of the REM message header fields shall be compliant to the structures defined from Figure 1 to Figure 4.

 Table 2 contains a mapping between the general semantic content of ERDS and the same concepts applied to REM header fields. The presence requirements are defined in Table 5 of ETSI EN 319 522-2 [8] and clause 6.2.1 of ETSI EN 319 532-2 [11]. Header fields not listed in Table 2 may be absent in REM.

 Clause 6.2 shall define where the header fields of Table 2 shall apply and other header fields specific for REM.

 Table 2: ERD to REM semantic content mapping

 Semantic content (Table 5, Table 6 of ETSI EN 319 522-2 [8])

 Mapping to IETF RFC 5322 [4] header fields

Metadata version REM-MetadataVersion: header field. This value shall be formatted as defined in ETSI EN 319 522-2 [8], clause 6.2.1 MD01 and it shall contain the version number of the present document according to the format EN31953203<version> (with the capital 'V' and replacing the dots by 0, e.g. if the current version is v1.2.1 then the MetaData version is EN31953203V010201). Relay date and time REM-RelayDate: header field. The format of this value shall be as defined in ETSI EN 319 522-2 [8], clause 6.2.2 MD02 and ETSI EN 319 522-3 [9], clause 4.3.7, and mapped according to clause 3.3 of IETF RFC 5322 [4]. Expiry date and time REM-ExpirationDate: header field. The format of this value shall be as defined in ETSI EN 319 522-2 [8], clause 6.2.3 MD03 and ETSI EN 319 522-3 [9], clause 4.3.8. mapped according to clause 3.3 of IETF RFC 5322 [4]. Recipient required assurance level REM-RecipientAssuranceLevel: header field. This value shall be formatted as defined in ETSI EN 319 522-2 [8], clause 6.2.4 MD04 and ETSI EN 319 522-3 [9], clause 4.3.14, and mapped in REM according to extension mechanisms defined in clause 6.2.1 or clause 6.2.5 for structured information. Applicable policy REM-ApplicablePolicy: header field. This value shall be formatted as defined in ETSI EN 319 522-2 [8], clause 6.2.5 MD05and ETSI EN 319 522-3 [9], clause 4.3.15. If there is more than one applicable policy, then the header field shall appear as many times as needed, and each occurrence shall contain one of the applicable policies. Mode of consignment REM-ModeOfConsignment: header field. This value shall be as defined in ETSI EN 319 522-2 [8], clause 6.2.6 MD06. It shall contain one of the URIs defined in ETSI EN 319 522-3 [9], clause 4.3.16. Scheduled delivery REM-ScheduledDelivery: header field. The format of this value shall be as defined in ETSI EN 319 522-2 [8], clause 6.2.7 MD07 and ETSI EN 319 522-3 [9], clause 4.3.9, and mapped according to clause 3.3 of IETF RFC 5322 [4]. Sender's identifier This value shall have the semantics defined in ETSI EN 319 522-2 [8], clause 6.2.8 MD08, it shall be formatted as specified in ETSI EN 319 522-3 [9], clause 4.3.10, and mapped in REM according to extension mechanisms defined in clause 6.2.1 or clause 6.2.5 for structured information. Sender's reply to address Reply-To: header field. This value shall have the semantics defined in ETSI EN 319 522-2 [8], clause 6.2.9 MD09, it shall be formatted as specified in clause 5. In REM messages it shall be mapped as specified in Table 3 of clause 6.2.1.


 Semantic content (Table 5, Table 6 of ETSI EN 319 522-2 [8])

 Mapping to IETF RFC 5322 [4] header fields

Recipient's identifier This value shall have the semantics defined in ETSI EN 319 522-2 [8], clause 6.2.10

- MD10, it shall be formatted as specified in ETSI EN 319 522-3 [9], clause 4.3.12, and mapped in REM according to extension mechanisms defined in clause 6.2.1 or clause 6.2.5 for structured information. ERD Message identifier Message-ID: header field. This value shall be as defined in ETSI EN 319 522-2 [8], clause 6.2.11 - MD011 and ETSI EN 319 522-3 [9], clause 4.3.4. In REM it shall be mapped as in Table 3 of clause 6.2.1. In reply to In-Reply-To: header field. This value shall be as defined in ETSI EN 319 522-2 [8], clause 6.2.12 - MD12 and ETSI EN 319 522-3 [9], clause 4.3.6. In REM it shall be mapped as in clause 3.6.4 of IETF RFC 5322 [4]. User content information: Content type

Content-Type: header field. This value shall be as defined in ETSI EN 319 522-2 [8], clause 6.2.14 MD14 and ETSI EN 319 522-3 [9], clause 4.3.13. In REM it shall be mapped as in Table 3 of clause 6.2.1. User content information: Subject Subject: header field This value shall be as defined in ETSI EN 319 522-2 [8], clause 6.2.14 MD14 and ETSI EN 319 522-3 [9], clause 4.3.4. In REM it shall be mapped as in Table 3 of clause 6.2.1. ERD Message type REM-MessageType: header field. This value shall be as defined in ETSI EN 319 522-2 [8], clause 6.2.13 MD13. It shall contain one of the URIs defined in ETSI EN 319 522-3 [9], clause 4.3.5, except in case of REMS notification, when the value shall be: [http://uri.etsi.org/19522/v1#/ERDMessageType/notification](http://uri.etsi.org/19522/v1#/ERDMessageType/notification) User content information: Digest algorithm

REM-DigestAlgorithm: header field. This value shall be as defined in ETSI EN 319 522-2 [8], clause 6.2.14 MD14 and ETSI EN 319 522-3 [9], clause 4.3.13. In REM it should be mapped as a URI compliant with section 4.2 of IETF RFC 6931 [i.9]. User content information: Message digest

REM-DigestValue: header field. This value shall be as defined in ETSI EN 319 522-2 [8], clause 6.2.14 MD14 and ETSI EN 319 522-3 [9], clause 4.3.13. In REM it should contain the base64 encoded digest value of original message as computed using the digest algorithm indicated in the aforementioned header field. User content information: Message original identifier

REM-UAMessageIdentifier: header field. This value shall be as defined in ETSI EN 319 522-2 [8], clause 6.2.11 MD11 and ETSI EN 319 522-3 [9], clause 4.3.4. In REM it should contain the Message-ID value of the original message submitted by the ERD-UA. User content information: AttachmentInformation

This value shall be formatted as defined in ETSI EN 319 522-2 [8], clause 6.2.14. In REM it is related to attachment information natively contained in the MIME header fields (see note 1 in Table 1). This may be further explicitly mapped in REM according to extension mechanisms defined in clause 6.2.1 or clause 6.2.5 for structured information. Signature See header fields in clause 6.2.7. Event identifier REM-EventIdentifier: header field. This value shall be as defined in ETSI EN 319 522-2 [8], clause 8.2.3 G03. It shall contain a URI defined in Table 3 of ETSI EN 319 522-3 [9], clause 5.2.2.5. Extensions Other metadata may be specified with the extension mechanism defined in clause 6.2.1 or clause 6.2.5 for structured information. This value shall be formatted as defined in ETSI EN 319 522-2 [8], clause 6.2.15 MD015 and ETSI EN 319 522-3 [9], clause 4.3.17.

#### 6.2 REM message structure

##### 6.2.1 REMS relay metadata MIME Header Fields

 The header fields defined in Table 3 and their respective values shall conform to the references in column 4.


 Table 3: Basic header fields bodies in REM message

Header field name Header field body Presence Reference Content-Type: The value for this header field shall be "multipart/signed".

- 'protocol' parameter value shall be     "application/pkcs7-signature".

- 'micalg' parameter value should be     conformant to ETSI TS 119 312 [i.2].

- 'boundary' parameter value should be     conformant to IETF RFC 2046 [13],     section 5.1.1.

 Mandatory Section 5 of IETF RFC 2045 [12] and section 3.4.3.2 of IETF RFC 5751 [3]

MIME-Version: The value for this header field shall be "1.0". Mandatory Section 4 of IETF RFC 2045 [12] Message-ID: The value for this header field should be an UID as defined in IETF RFC 5322 [4].

Mandatory Section 3.6.4 of IETF RFC 5322 [4] Date: The value for this header field shall be compliant with clause 3.3 of IETF RFC 5322 [4].

Mandatory Section 3.3 of IETF RFC 5322 [4] From: The value for this header field should be either a REMSP service address (e.g. "<service_rem_md_x@rem_md_x.com>" or a transformation of the original From field to show the role of the REMSP (e.g. "on behalf of user@rem_md_x.com <service_rem_md_x@rem_md_x.com>").

 Mandatory Section 3.6.2 of IETF RFC 5322 [4]

To: In case of a REM dispatch or REM payload the value for this header field shall match the value of the 'To' header field in the original message. In case of a REM message carrying evidence for the sender, the value for this header field may match the value of the 'From' header field in the original message.

 Mandatory Section 3.6.3 of IETF RFC 5322 [4]

Cc: REMS should assign a value to this header field only for REM dispatch. In such case, the value shall match the value of the 'Cc' header field in the original message.

 Optional Section 3.6.3 of IETF RFC 5322 [4]

Subject: The value for this header field should be transformed as follows starting from the Subject header field contained in the original sender's message, in order to indicate the role that the REM message has within the flow: REM <event identifier>: <original subject> (E.g.: "REM ContentConsignment: subject_of_original_message").

 Mandatory Section 3.6.5 of IETF RFC 5322 [4] ETSI EN 319 522-3 [9], column 2 of Table 3 for the full list of the ERDS event identifiers

Reply-To: In the case of a REM dispatch or REM payload the value for this header field shall match the value of the 'From' header field in the original message. In the case of a REM message carrying evidence for the sender, this header field should not appear, and if it appears, its value should be the REM service address.

 Conditional Section 3.6.2 of IETF RFC 5322 [4]

Return-Path: REMS may assign a value to this header field only for REM dispatch. In such case, the value should match the value of the 'Return-Path' header field in the original message.

 Optional Section 3.6.7 of IETF RFC 5322 [4]

Received: REMS may assign a value to this header field only for REM dispatch. In such case, the value shall match the value of the 'Received' header field in the original message.

 Optional Section 3.6.7 of IETF RFC 5322 [4]

In-Reply-To: REMS may assign a value to this header field. The value should match the value of the 'InReply-To' header field in the original message.

 Optional Section 3.6.4 of IETF RFC 5322 [4]


The present header section of a REM message shall contain the following header fields according to the requirements of presence and format defined in Table 2:

- REM-MetadataVersion:

- REM-RelayDate:

- REM-ExpirationDate:

- REM-RecipientAssuranceLevel:

- REM-ApplicablePolicy:

- REM-ModeOfConsignment:

- REM-ScheduledDelivery:

- REM-MessageType:

- REM-DigestAlgorithm:

- REM-DigestValue:

- REM-UAMessageIdentifier:

- REM-EventIdentifier:

Furthermore, the header section of each REM message may contain other basic extension header fields. The purpose of these header fields is to give immediate access to important identification information instead of forcing the REMS to process the ERDS evidence.

 NOTE 1: As evident in the list above, the REM implementation-specific extensions header fields follow the best current practice on naming convention recommended in IETF RFC 6648 [i.3], clause 3, without prefix X-. These headers are clearly visible and identifiable by the prefix "REM-".

The syntax of these basic extension header fields shall be as follows:

REM-<component>: <value>

where:

- <component> is a label (possibly equal to the identification code of a ERDS relay metadata or evidence     component/subcomponent).

 NOTE 2: See Table 5 in ETSI EN 319 522-2 [8], clause 6.1 for a full list of identification codes of ERDS relay metadata components e.g. MD01, MD02, etc.

- See Table 6 in ETSI EN 319 522-2 [8], clause 8.1 for a full list of identification codes of ERDS evidence components - e.g. G01, R01, I01, etc.

- <value> is a correspondent value for the component.

The same naming mechanism should be used also for other implementation-specific or custom header fields.

The following example shows the usage of the aforementioned mechanism to add two header fields:

 EXAMPLE:

- REM-G02: <Evidence version value>

- REM-R01: <Evidence issuer policy identifier>

In case the character set of the <value> to assign to any aforementioned header fields is not compliant with the supported email standards, a base64 encoding should be used for a consistent representation in a unique header field body.


In case of structured information, not easily convertible to a simple header body, the REMS structured extension defined in clause 6.2.5 may be used to host the full structure in a specific file as attachment.

In REMS operating in Store & Notify style of operation, the present header section of the REMS notification shall contain also the following header field, according to the requirements defined in ETSI EN 319 532-2 [11], clause 6.2.1:

- REM-AcceptanceRejectionInterfaceLocation: <URI>

##### 6.2.2 signed data MIME Header Fields

The header fields defined in Table 4 and their respective values shall conform to the references in column 4.

 Table 4: Signed data header field boundary in REM message

 Header field name Header field body Presence Reference Content-Type: The value for this header field shall be: "multipart/mixed"

- 'boundary' parameter value should be     conformant to IETF RFC 2046 [13],     section 5.1.1.

 Mandatory Section 5 of IETF RFC 2045 [12]. Sections 5, 5.1 and 5.1.3 of IETF RFC 2046 [13]

##### 6.2.3 REMS introduction MIME Header Fields-Body

###### 6.2.3.1 General requirements

The header fields defined in Table 5, Table 6, Table 7 and their respective values shall conform to the references in column 4.

 Table 5: Introduction header fields boundary

Header field name Header field body Presence Reference REM-Section-Type: The value of this field should be "rem_message/introduction".

 Optional N/A

Content-Type: The value for this field shall be: "multipart/alternative"

- 'boundary' parameter value should be     conformant to IETF RFC 2046 [13],     section 5.1.1.

 Mandatory Section 5 of IETF RFC 2045 [12]. Sections 5, 5.1 and 5.1.4 of IETF RFC 2046 [13]

 NOTE: The order chosen for the following two parts (mutually interchangeable bodies of the "multipart/alternative" header field defined in Table 5) ends with the choice that the email clients usually interpret as preferred, as indicated in IETF RFC 2046 [13] (the best choice is the LAST part of a type supported by the recipient system's local environment).

###### 6.2.3.2 multipart/alternative: free text subsection Header Fields

 Table 6: Introduction header fields bodies free text case

 Header field name Header field body Presence Reference Content-Type: The value for this field shall be: "text/plain".

- 'charset' parameter value     should be "UTF-8".

 Mandatory Section 5 of IETF RFC 2045 [12]. Sections 5, 5.1 and 5.1.4 of IETF RFC 2046 [13] Content-Disposition: The value of this header field shall be "inline" in order to display the present body part automatically, upon display of the message in mail client.

 Optional Section 2.1 of IETF RFC 2183 [2]

 Content-Transfer-Encoding: The value for this field should be: 7bit, 8bit or quoted-printable.

 Mandatory Section 6 of IETF RFC 2045 [12]


###### 6.2.3.3 multipart/alternative: HTML subsection Header Fields

 Table 7: Introduction header fields bodies HTML case

 Header field name Header field body Presence Reference Content-Type: The value for this field shall be: "text/html;".

- 'charset' parameter value     should be "UTF-8".

 Mandatory Section 5 of IETF RFC 2045 [12] and IETF RFC 2854 [5]

 Content-Transfer-Encoding: The value for this field should be: 7bit, 8bit or quoted-printable.

 Mandatory Section 6 of IETF RFC 2045 [12]

###### 6.2.3.4 Introduction body formats

The introduction text for the REM message is positioned in two different places represented by the body parts of the clauses 6.2.3.2 for plain-text and 6.2.3.3 for HTML. If both sections are present their contents shall be an alternative and equivalent version of the same information in both plain text and HTML formats. The body of HTML text shall not contain active code.

If it contains some URL, the printed part (that is the Hypertext visible to the user) shall be the same as the hidden part (that is the real location where the web browser is redirected clicking on it).

 NOTE: As indicated in the note 3 in clause 4.2, the introduction text represents one of the places where to indicate to the users of the REM service any rectification applied to some header field of submission metadata by the REMS.

##### 6.2.4 original message MIME Header Fields

###### 6.2.4.1 original message general requirements

Clauses 6.2.4.2 and 6.2.4.3 specify requirements for the MIME header fields and body (whole MIME) corresponding to the original message section (see Figure 1 and Figure 4 for its placement inside a REM message). These requirements apply only when the message is conveyed to the recipient by value.

###### 6.2.4.2 original message MIME section Header Fields

The header fields defined in Table 8 and their respective values shall conform to the references in column 4.

 Table 8: Original message header fields bodies

 Header field name Header field body Presence Reference Content-Type: The value for this field shall be: "message/rfc822".

- 'name' parameter value shall be     "AttachedMimeMessage".

 Mandatory Section 5 of IETF RFC 2045 [12]; section 5.2 of IETF RFC 2046 [13] Content-Transfer-Encoding: The value of this header field shall be "binary". Mandatory Section 6 of IETF RFC 2045 [12] and section 5.2.1 of IETF RFC 2046 [13] Content-Disposition: The value for this field shall be: "attachment".

- 'filename' parameter value shall match     the value of the 'name' parameter of the     Content-Type: header field.

 Mandatory Sections 2.2 and 2.3 of IETF RFC 2183 [2]

 Content-Description: The value for this header field may be a brief text describing the type of extension.

 Optional Section 8 of IETF RFC 2045 [12] REM-Section-Type: The value of this field should be "rem_message/original".

 Optional N/A

 NOTE: These header fields are not parts of the submission metadata but headers defining the structure of REMS.


###### 6.2.4.3 original message MIME section Body formats

It contains the submission metadata and the user content as the sender submits it.

 NOTE: From the formal viewpoint, the user content is part of the original message but is not part of the REMS relay metadata (object of clause 6). Anyway, it is introduced here to define the place where it appears inside the entire morphology and to maintain the coherence with the MIME structure description.

The REMS may modify some header fields of the original message, only if the change is limited to what is strictly necessary for the good working of the REM exchange of information.

 EXAMPLE: The MessageID can be changed, see notes 2 and 3 in clause 4.2.

Furthermore, any necessary change shall be clearly indicated to the sender (e.g. in the evidence) and to the recipient (e.g. in the evidence and/or in the introduction message defined in clause 6.2.3.4).

##### 6.2.5 REMS extensionsMIME Header Fields

This MIME part shall be used to contain structured extensions.

The header fields defined in Table 9 and their respective values shall conform to the references in column 4.

 Table 9: Extensions header fields bodies

 Header field name Header field body Presence Reference Content-Type: The value for this header field should be either "application/xml" or application/octet-stream.

- 'name' parameter value should     be     "<REM_EXTENSION_NAME>".

- 'charset' parameter value should     be "UTF-8" in case of xml     attachments.

 Mandatory Section 5 of IETF RFC 2045 [12]. Section 4.5 of IETF RFC 2046 [13] and IETF RFC 7303 [6]

 Content-Transfer-Encoding: The value of this header field shall be either "quoted-printable", "base64" or "binary".

 Mandatory Section 6 of IETF RFC 2045 [12]

 Content-Disposition: The value of this header field shall be "attachment".

- 'filename' parameter value shall     match the value of the 'name'     parameter of the Content-Type     header field.

 Mandatory Sections 2.2 and 2.3 of IETF RFC 2183 [2]

 Content-Description: The value for this header field should be a brief text describing the type of extension.

 Optional Section 8 of IETF RFC 2045 [12] REM-Section-Type: The value of this field should be "rem_message/extension".

 Optional N/A

 REM-Extension-Code: The value of this field should be, in accordance with the type of the attachment, a unique code identifying the type of extension in order to allow automatic processing.

 Optional See below in the present clause

 REM-Extension-Namespace-URI: The value of this field should contain the namespace URI relevant to the extension.

 Optional See below in the present clause

The structures and/or the names or type-extensions of these optional attachments are not defined here, since they are left for any possible extensions to be agreed on a peer-to-peer basis (e.g. automatic processing of download URI in S&N style of operation, insertion of Electronic PostMark, etc.) or to cover particular requirements coming in the future.

In particular, one of these extensions may be used to associate an electronic time stamp (see note) to the REM message certifying the date and time of sending, receiving and/or any change/transformation of the message transmitted from the sender to the recipient.


In case one extension is used to transport information relevant to the time to which the event (message or evidence) is referring, all the time references present in REM message (e.g. G05 Event Time defined in table 6 of ETSI EN 319 522-2 [8], clause 8.1) shall report a unique and aligned time value to that provided by the electronic time stamp. This unique value shall be the official certified time reference related to the event (e.g. the precise date/time of taking in charge/transferring the responsibility about a digital communication).

 NOTE: Time-stamp can also be incorporated in the signature as indicated in clause 8.3.

Other extensions with other purposes may be contemporarily present.

As defined in Table 2 and clause 6.2.1, extensions may also contain structured metadata or evidence components. In these cases:

- REM-Extension-Code: value shall contain the component code identifying the related metadata or     evidence component in Table 5 or Table 6 of ETSI EN 319 522-2 [8] (e.g. I06...).

- The "name" component of the Content-Type: header field: <REM_EXTENSION_NAME> shall be     based on the component name identifying the related metadata or evidence component in Table 5 or     Table 6 of ETSI EN 319 522-2 [8] (e.g. name="Recipient's delegate identifier.xml").

- REM-Extension-Namespace-URI: should contain the target name space URI for the structured     component.

##### 6.2.6 ERDS evidence MIME Header Fields

###### 6.2.6.1 General requirements

The present clause defines the specific header fields provided for the ERDS evidence contained inside a REM message (see clause 7 for the whole evidence set and from Figure 1 to Figure 3 for the incorporation of ERDS evidence within a REM message).

The ERDS evidence should be in XML format. It may be in PDF format.

The XML format is further specified in clause 7.4. The PDF format is out of scope.

The tag < REM_EVIDENCE_NAME> present in Table 10 and Table 11 should be replaced with the event identifier G03 to which it relates plus the ".xml" extension (e.g. SubmissionAcceptance.xml, SubmissionRejection.xml, etc.).

 NOTE: See Table 3 column 2 of ETSI EN 319 522-3 [9], clause 5.2.2.5 and Table 1 column 2 of ETSI EN 319 522-1 [7] for a complete list of event identifiers.

According to the structures and the presence requirements defined in Figure 1, Figure 2 and Figure 3 it is allowed to attach more than one ERDS evidence to each REM message, if its type allows to attach ERDS evidence. These additional evidence attachments (eventually different in terms of semantic/content/name from all the ERDS evidence set provided with the present document) obey to peer-to-peer and/or interoperability agreements and/or specific profiles. In any case, these additional evidence attachments should be specified, in the MIME header fields structure, according with their type, in a similar way of that defined in clauses 6.2.6.2 (for XML), 6.2.6.3 (for PDF) and 6.2.5 (for other types of attachments).

###### 6.2.6.2 Header Fields for XML ERDS evidence usage

This clause specifies the header fields in case the REM message incorporates ERDS evidence in XML format.

The header fields defined in Table 10 and their respective values shall conform to the references in column 4.


 Table 10: XML evidence header fields bodies

 Header field name Header field body Presence Reference Content-Type: The value for this header field shall be "application/xml"

- 'name' parameter value shall be     "<REM_EVIDENCE_NAME>.xml".

- 'charset' parameter value shall be     "UTF-8".

 Mandatory Section 5 of IETF RFC 2045 [12]. Section 4.5 of IETF RFC 2046 [13] and IETF RFC 7303 [6], clause 6.2.6.1 for 'name' parameter Content-TransferEncoding:

 The value of this header field shall be either "quoted-printable", "base64" or "binary".

 Mandatory Section 6 of IETF RFC 2045 [12] Content-Disposition: The value of this header field shall be "attachment"

- 'filename' parameter value shall match     the value of the 'name' parameter of     the Content-Type: header field.

 Mandatory Sections 2.2 and 2.3 of IETF RFC 2183 [2]

 Content-Description: The value for this header field may be a brief text describing the type of ERDS evidence.

 Optional Section 8 of IETF RFC 2045 [12] REM-Section-Type: The value of this field should be "rem_message/xml_evidence".

 Optional N/A

###### 6.2.6.3 Header Fields for PDF ERDS evidence usage

This clause specifies the fields for the header in case the REM message incorporates ERDS evidence as PDF documents.

The header fields defined in Table 11 and their respective values shall conform to the references in column 4.

 Table 11: PDF evidence header fields bodies

 Header field name Header field body Presence Reference Content-Type: The value for this header field shall be "application/pdf"

- 'name' parameter value shall be "<REM     EVIDENCE_NAME>.pdf".

 Mandatory Section 5 of IETF RFC 2045 [12]. Section 4.5 of IETF RFC 2046 [13] and IETF RFC 8118 [1]; clause 6.2.6.1 for 'name' parameter Content-Transfer-Encoding: The value of this header field shall be "base64" or "binary".

 Mandatory Section 6 of IETF RFC 2045 [12] and IETF RFC 8118 [1] Content-Disposition: The value of this header field shall be "attachment"

- 'filename' parameter value shall match     the value of the 'name' parameter of the     Content-Type: header field.

 Mandatory Sections 2.2 and 2.3 of IETF RFC 2183 [2]

 Content-Description: The value for this header field may be a brief text describing the type of ERDS evidence.

 Optional Section 8 of IETF RFC 2045 [12] REM-Section-Type: The value of this field should be "rem_message/pdf_evidence".

 Optional N/A

##### 6.2.7 REMS signature MIME Header Fields-Body

The header fields defined in Table 12 and their respective values shall conform to the references in column 4.


 Table 12: Signature header fields bodies in REM message

 Header field name Header field body Presence Reference Content-Type: The value for this header field shall be: "application/pkcs7signature; name=smime.p7s".

- The parameter 'name'     should be present,     indicating "SignedData",     as defined above.

 Mandatory Section 5 of IETF RFC 2045 [12]. Sections 3.2.1 and 3.4.3.3 of IETF RFC 5751 [3]

 Content-TransferEncoding:

 The value for this header field shall be: "base64".

 Recommended Sections 3.1.2 and 3.4.3.3 of IETF RFC 5751 [3] Content-Disposition: The value for this header field shall be: "attachment"

- 'filename' parameter     value should be     "smime.p7s".

 Mandatory Sections 3.2.1 and 3.4.3.3 of IETF RFC 5751 [3]

 Content-Description: The value for this header field may be: "S/MIME Cryptographic Signature".

 Optional Section 8 of IETF RFC 2045 [12]

Even if sender REMSs have to include the Content-Disposition field and fill in the name/filename parameters, recipient REMSPs shall be able to correctly interpret incoming messages without Content-Disposition and/or filename parameters.

## 7 REMS evidence set formats

The present clause provides requirements for the format of the ERDS evidence set relevant for REM attesting the ERDS events as detailed in ETSI EN 319 532-1 [10], clause 6.

Requirements for XML ERDS evidence defined in ETSI EN 319 522-3 [9], clause 5 shall apply.

 NOTE: The XML schema file location for namespace is provided in ETSI EN 319 522-3 [9], Annex A. The URIs corresponding to the namespace and the prefixes associated to them are defined in ETSI EN 319 522-3 [9], clause 4.3.1.

Furthermore, other mappings may be supported as agreements among interested parties.

## 8 REMS signatures formats

#### 8.1 General

The present clause specifies the format of the signatures involved in REM messages. For this purpose ETSI EN 319 522-2 [8], clause 7 shall apply.

The algorithms and key lengths used to generate digital signatures should be as specified in ETSI TS 119 312 [i.2].

Within a REM message the following digital signatures shall apply:

- Signatures generated by a REMS or by the delegated entity on each ERDS evidence individually.

- S/MIME signature protecting all the MIME parts that constitute a REM message. This signature is generated     by a REMS.

 NOTE: Senders can additionally sign the original message submitted to the recipient, supporting the signature with their own certificates. These signatures are outside the scope of the present document.

All the above signatures may coexist, each securing one part of the REM message.


The next clauses specify the details relevant to formats of the signatures that apply on the different parts composing a REM message.

#### 8.2 Signatures individuallysigning ERDS Evidence

Signatures individually signing ERDS evidence shall comply with ETSI EN 319 522-2 [8], clause 7.2 and ETSI EN 319 522-3 [9], clause 5.2.2.28.

In addition, in case PDF evidence format is used, the evidence should be protected by PAdES digital signatures as defined in ETSI EN 319 142-1 [i.7].

#### 8.3 Signatures on REM messages

For signatures that sign all the components of REM messages ETSI EN 319 522-2 [8], clause 7.2 shall apply.

In addition:

 1) The signature shall be applied to the message using S/MIME multipart/signed as defined in IETF RFC 5751 [3]. This signature shall protect all the MIME parts that constitute a REM message.

 2) The digital signature should be a CAdES signature according to the semantics specified in ETSI EN 319 522-2 [8], clause 8.2.9.

 NOTE: For the purposes to cover advanced digital signature on MIME, CAdES specification provides examples of structured contents, MIME and S/MIME digital signatures in Annex D of ETSI EN 319 122-1 [i.6].

 3) This digital signature should be a CAdES baseline signature as specified in ETSI EN 319 122-1 [i.6]. This digital signature may include the signed attribute signature-policy-identifier, containing the explicit identifier of the signature policy governing the signing and validating processes. Once the CAdES-B-B baseline signature has been generated, it should be augmented to a CAdES-B-T baseline signature by incorporation into the digital signature of the unsigned attribute signature-timestamptamp, containing a time-stamp token computed as specified in ETSI EN 319 122-1 [i.6]. The signing certificate of this digital signature shall meet the requirements specified in in ETSI EN 319 522-2 [8], clause 9.3.

## 9 Common Service Interface formats

#### 9.1 General requirements

The requirements and explanations given in clause 9 of ETSI EN 319 532-2 [11] shall apply.

See the same clause for an introduction to the common service interface.

#### 9.2 Routing information

The REM RI (Relay Interface) should be identified by a transport protocol, a hostname and a port number.

 EXAMPLE: When the REMS uses SMTP for relay and uses DNS for routing, then for the target REM RI the protocol is implicitly SMTP, the port is implicitly 25, and the hostname is the one found in the MX record of the DNS when queried for the domain part of the recipient's identifier (which has the format of an email address, see clause 5). The target REMS can provide multiple REM RIs, and so the DNS MX records can contain multiple hostnames.

Other techniques may be used either according to clause 6.1 of ETSI EN 319 522-3 [9], peer-to-peer agreements between REMSPs or based on the best practices recommended in Annex A of ETSI EN 319 532-4 [i.1].


#### 9.3 Trust information

The requirements and explanations given in clauses 7.2 and 7.3 of ETSI EN 319 522-4-3 [i.8] should apply to REM, with the following amendments.

If Trusted List (TL) is used to publish trust information about a REMS, then the section describing a REM service shall be populated in conformance to ETSI TS 119 612 [15], with the restrictions defined in Table 13.

If Trusted List is used to establish trust with another REMS, then the information in the TL should be interpreted as defined in Table 13.

 Table 13: Provision of REMS trust information when using Trusted List

 Trusted list field Optionality Value (see ETSI TS 119 612 [15]) Service type identifier (as per clause 5.5.1 of ETSI TS 119 612 [15])

 M This element shall be one of the following:

- [http://uri.etsi.org/TrstSvc/Svctype/EDS/REM.](http://uri.etsi.org/TrstSvc/Svctype/EDS/REM.)

- [http://uri.etsi.org/TrstSvc/Svctype/EDS/REM/Q.](http://uri.etsi.org/TrstSvc/Svctype/EDS/REM/Q.) Service digital identity (as per clause 5.5.3 of ETSI TS 119 612 [15])

 M This element shall contain an X.509 certificate, which shall be one of the following:

- A single certificate used by the REMS for digital     signing of all REM messages and ERDS evidence.

- A single CA certificate that is used solely for the     purpose of issuing certificates to components of the     REMS for digital signing of REM messages and/or     ERDS evidence. This element may contain optionally the corresponding X509SKI element. Service supply point (as per clause 5.5.7 of ETSI TS 119 612 [15])

 M This element should provide one or more URIs to access the REM RI (Relay Interface) defined in clause 5 of ETSI EN 319 532-1 [10]. Depending on the implemented transport protocol, this element may provide a pointer e.g. to an SMTP server, to a web service, etc. If the Relay Interface is provided using SMTP then this URI should be an smtp: URI. TSP service definition URI (as per clause 5.5.8 of ETSI TS 119 612 [15])

 O If present, this URI may point to published general information relevant to the users like public certificates, addresses, etc. Service information extensions (as per clause 5.5.9 of ETSI TS 119 612 [15])

 O If present, extensions shall not be set as critical.

#### 9.4 Capability management

The REMS capability metadata should be in the format specified in clause 6.3.2 of ETSI EN 319 522-3 [9].

If the REMS uses TL to publish trust information about itself, the REMS capability metadata may also be published using the TL, as indicated for ERDS capability metadata in clause 7.2 of ETSI EN 319 522-4-3 [i.8]. In this case the options given in Table 14 may be used.

 Table 14: Provision of REM capability information when using Trusted List

 Trusted list field Optionality Value (see ETSI TS 119 612 [15]) TSP service definition URI (as per clause 5.5.8 of ETSI TS 119 612 [15])

 O If present, this element may contain a URI, where the REMS capability metadata is downloadable. Service information extensions (as per clause 5.5.9 of ETSI TS 119 612 [15])

 O If present, the additionalServiceInformation field, as per clause 5.5.9.4 of ETSI TS 119 612 [15], may contain a URI, where the REMS capability metadata is downloadable, or alternatively, it may embed the REMS capability metadata structure itself (if it is in XML format).

Furthermore, other protocols or adaptations of the aforementioned processes may be supported, according to other documents like agreements among interested parties.


The identification of the recipient is possible also before the relay of the REM message from the sender's REMS to the recipient's REMS by means of the aforementioned discovery techniques or according to peer-to-peer protocols agreed between REMSP.


## Annex A (informative):

## REM message examples

This annex provides a set of examples containing notions to assist implementers to the proper interpretation and application of the provisions supplied in the present document.

 Full SMTP Stream compliant with IETF RFC 5321 [14] Boundaries marked for mapping S: 220 smtp.senderdomain.rem ESMTP ready C: EHLO pc-sender.senderdomain.rem S: 250-smtp.senderdomain.rem S: 250-PIPELINING S: 250-SIZE 41697280 S: 250-8 BITMIME S: 250-DSN S: 250-AUTH=LOGIN S: 250-AUTH LOGIN PLAIN C: AUTH LOGIN S: 334 VXNlcm5hbWU6 C: c2VuZGVyQHNlbmRlcmRvbWFpbi5yZW0= S: 334 UGFzc3dvcmQ6 C: ZXRzaS1zdGY1MjM= S: 235 LOGIN authentication successful C: MAIL FROM:<sender@senderdomain.rem> S: 250 MAIL FROM:<sender@senderdomain.rem> OK C: RCPT TO:<recipient@recipientdomain.rem> S: 250 RCPT TO:<recipient@recipientdomain.rem> OK C: DATA S: 354 Start mail input; end with <CRLF>.<CRLF> C: C: C: C:

 C: C: C: C: C:

 Date: Thu, 15 Dec 2016 13:01:34 +0100 From: Sender Name <sender@senderdomain.rem> Subject: Purchase order #1237 To: recipient@recipientdomain.rem

 Dear Sir, thank you for ordering on our online site. Keep your order number for tracking the status at any time. Best Regards

 C:. S: 250 OK Mail accepted C: QUIT S: 221 smtp.senderdomain.rem quit the channel. Bye.

 transport & auth information

 Header section (submission metadata) original message

 Body (sender's user content)

 closure information

 Figure A.1: Boundaries in email stream example

In the example of Figure A.1, fully compliant with IETF RFC 5321 [14], the original message represents the fundamental part examined in the present document.

For comparison with the definitions contained in ETSI EN 319 522, the transport information and closure information sections are separated and represent the "transport metadata".

 NOTE 1: Further considerations regarding specific protocol elements like transport and closure are out of scope of the present document and are, in some measure, managed in ETSI EN 319 532-4 [i.1], clause 5.3.5 CSI.

By contrast, the Header section contains the submission metadata. Finally, the body section holds the user content.

From some viewpoint, also the subject and perhaps the addresses header fields could be considered part(s) of the user content (as contents that the sender specifies together the body of the message). This theoretical view is masked by applications, which are normally used by the sender like email client and/or webmail. To maintain coherence with widely recognized separation header/body sections, defined also in email international standards, and to simplify the exposition, these header fields are considered outside the user content and inside the header section.

Header section and body, together, form the original message and they represent the real object that is intended to be conveyed to the recipient(s). Therefore, the original message contains some metadata.


 NOTE 1: The main body part of the REM message is the place where to put some explanatory/introduction text indicating the composition of the message and / or elements to recognize the nature of the attachments (original message and / or ERDS evidence) and / or the description of eventual changes applied to some header fields of the submission metadata (see also Figure A.3). NOTE 2: The header section of the original message (originally called submission metadata) changes its nature after it is picked up by REMS and becomes part of the REMS relay metadata.

 Figure A.2: Enveloping of REM dispatch in email stream example

The example of Figure A.2 illustrates how the same standard wrapping mechanism like that described in Figure A.1 is used to create the REM message structure. In case of a REM dispatch, this package is used to transport the original message as attachments.

So the original message is wrapped inside a body part of a new digitally signed message used to protect the sender's message up to the recipient. Since the wrapping and the digital signature of the original message are realized by means of standard processes, the recipient is able to access (and verify the REMS digital signature) the sender's message using standard email clients.

The REM message structure contains components for encapsulating ERDS evidence. Moreover, it is designed to contain:

 1) An introductory message-part displayed by the mail client application. Within this, the REMSP explains the purpose of the current message and gives some details on the other parts attached to. Eventually, also, if some element of the submission metadata has been modified (see note 2 and note 3 in clause 4.2). The actual message is also able to contain references to objects stored in a REMSP Repository.

 2) A digital signature generated by the REMS. It covers both the original message, when present, and the ERDS evidence.

 Example of a SMTP Stream produced by a REMS Boundaries marked for REM S: 220 ... C: EHLO ... S: 250-... S: 250-... S: 250-... S: 250-... S: 250 ... C: MAIL FROM:... S: 250 OK C: RCPT TO:... S: 250 OK C: DATA S: 354 Start mail input; end with <CRLF>.<CRLF>

 C: C: C: C: C:

 C: C: C:

 C: C: C:

 C: C:

 C: C:

 Date: Tue, 16 Jan 2018 08:30:00 From: REM Service Provider <...> Subject: REMS-Message (....) To: ...

 ... descriptive/introduction text about constitution of the REM dispatch ... ...

 ... Header section of original message plus BODY PARTS of original message ... (this part is optional)

 ... ERDS evidence attachment ...

 ... DIGITAL SIGNATURE ...

 C:. S: 250 OK C: QUIT S: 221 ....

 transport information

 Header REMS relay metadata

 Main body (note 1 ) REM dispatch Header section(note 2 ) original message

 ERDS evidence REMS Digital Signature

 closure information


 3) REMS Extensions place holder body parts (see note 2).

 NOTE 2: A possible use of one extension instance body part is to host an electronic time stamp, certifying the accuracy of the date and time of the event (sending, receipt or eventual changes) related to the current REM message. In such case, the current time stamp value (that is typically inside a structured information, as an example in a XML file), or the current time reference value is aligned with any date/time header field value of REM message and/or the ERDS evidence event time. It is not a good practice to have misaligned current time reference values among the significant time references (in any format, time zone etc. they are) present in each REM message. Another possibility is to host the time stamp in the signature as indicated in clause 8.3.

Figure A.3, without the grey part, presents the full skeleton of a generic REM message. When it includes the grey part (the original message MIME section), it represents the structure of a REM dispatch or a REM payload.

See from Figure 1 to Figure 4 for the concrete instantiation of this template with all types of REM message and the definition of the presence and/or the cardinality of each element.


REM message structure (in case of a REM message)

 Header

 MIME header fields profiled for a multipart/signed MIME message (see clause 6.2.1) [REMS relay metadata plus optionally REMS handover metadata]

 REM message body

 (signed data MIME section)

 Header

 MIME part header fields profiled for a multipart/mixed message (see clause 6.2.2) [REMS relay metadata]

 Body

 REMS introduction

 MIME section [REMS relay metadata]

 Header

 MIME part header fields profiled for a multipart/alternative MIME content (see clause 6.2.3)

 Body

 Plain text introduction

 Header

 MIME part header fields profiled for text/plain (see clause 6.2.3.2)

 Body

 A message created by the REMS, to be displayed automatically upon display of the REM message. Text contains URIs and/or other information for the user (see clause 6.2.3.4)

 HTML introduction

 Header

 MIME part header fields profiled for text/html (see clause 6.2.3.3)

 Body

 A message created by the REMS, to be displayed automatically upon display of the REM message. HTML contains URIs and/or other information for the user (see clause 6.2.3.4)

 original messageMIME section

 Header

 MIME part header fields profiled for an enveloped message/rfc822 message (see clause 6.2.4.2)

 Body

(^) Header and Body of a self-contained IETF RFC 5322 [4] message as submitted by the sender: the submission metadata that becomes part of the REMS relay metadata and the user content (see clause 6.2.4.3) REMS Extensions MIME section Header MIME part header fields profiled for extensions, e.g. application/xml (see clause 6.2.5) Body Optional attachment to be used by possible extensions ERDS evidenceMIME section Header MIME part header fields profiled for an application/xml or application/pdf (see clause 6.2.6) Body Optional ERDS evidence as required by the specific content-type REMSsignature Header MIME part header fields profiled to S/MIME application/pkcs7-signature signature on the whole REM message (see clause 6.2.7) Body S/MIME digital signature generated by the REMS covering the whole structure Figure A.3: REM message generic template


From sender@s-rems.rem Tue Jan 16 08:30:13 2018 Return-Path: <sender@s-rems.rem> Received: from rempot.s-rems.rem (10.87.5.22) by (172.16.241.100) remdp.s-rems.rem Received: by remwp.s-rems.rem (172.16.241.100) id C497D04258C3F264 for sender@s-rems.rem Received: from PC-STN (172.16.241.10) by smtpap.s-rems.rem (172.16.241.10) (authenticated as sender@s-rems.rem) Reply-To: "Sender name" <sender@s-rems.rem> From: "On behalf of: sender@s-rems.rem" <rem-service@s-rems.rem> To: <recipient@r-rems.rem> Subject: REM ContentConsignment: Purchase order #1237 Date: Tue, 16 Jan 2018 08:30:00 +0100 (CET) Message-ID: <76A0CF65.00566CE0.025BE6B4.85251369.rem-service@s-rems.rem> In-Reply-To: <44B2DA88.03101965.CE6B605.16011966.sender@senderdomain.rem> REM-MetadataVersion: EN31953203V010201 REM-RelayDate: 20180116073000Z REM-ExpirationDate: 20180215073000Z REM-RecipientAssuranceLevel: 3 REM-ApplicablePolicy: 1 REM-ModeOfConsignment: [http://uri.etsi.org/19522/v1#/consignment/basic](http://uri.etsi.org/19522/v1#/consignment/basic) REM-ScheduledDelivery: 20180116073010Z REM-MessageType: [http://uri.etsi.org/19522/v1#/ERDMessageType/dispatch](http://uri.etsi.org/19522/v1#/ERDMessageType/dispatch) REM-DigestAlgorithm: [http://www.w3.org/2001/04/xmldsig-more#sha384](http://www.w3.org/2001/04/xmldsig-more#sha384) REM-DigestValue: Ob+Ngy07MH2OQEr6fCeLuxhyDGHntEiGTm0gKnUeHYRqNZ052zU2yN9646ogYNWL REM-UAMessageIdentifier: <00be01d30072$fde7b950$f9b72bf0$@de> REM-EventIdentifier: [http://www.etsi.org/19522/Event/SubmissionAcceptance](http://www.etsi.org/19522/Event/SubmissionAcceptance) REM-Evidence-ID: <76A0CF65.00566CE0.025BE6B4.03B4A2C1.rem-service@s-rems.rem> REM-ReasonIdentifier: [http://uri.etsi.org/19522/EventReason/MessageAccepted](http://uri.etsi.org/19522/EventReason/MessageAccepted) REM-ReasonIdentifier: [http://uri.etsi.org/19522/EventReason/S_ERDS_MessageSuccessfullyRelayed](http://uri.etsi.org/19522/EventReason/S_ERDS_MessageSuccessfullyRelayed) REM-ReasonIdentifier: [http://uri.etsi.org/19522/EventReason/MessageConsignedToRecipient](http://uri.etsi.org/19522/EventReason/MessageConsignedToRecipient) REM-ReasonIdentifier: [http://uri.etsi.org/19522/EventReason/MessageHandedOver](http://uri.etsi.org/19522/EventReason/MessageHandedOver) REM-G02: EN319522.0.0.4.b MIME-Version: 1.0 Content-Type: multipart/signed; protocol="application/pkcs7-signature"; micalg=sha-512; boundary="----=_Part_26335066_750970089.1481841690001"

This is a multi-part message in MIME format.

------=_Part_26335066_750970089.1481841690001 Content-Type: multipart/mixed; boundary="----=_Part_26335064_533604049.1481841694172"

------=_Part_26335064_533604049.1481841694172 REM-Section-Type: rem_message/introduction Content-Type: multipart/alternative; boundary="----=_Part_26335063_498347107.1481841694173"

------=_Part_26335063_498347107.1481841694173 Content-Type: text/plain;charset="UTF-8" Content-Transfer-Encoding: quoted-printable

 *** REM DISPATCH *** This is a REM dispatch Subject: Purchase order #1237 The original message is attached. ... continue with the introduction TEXT message here ...

------=_Part_26335063_498347107.1481841694173 Content-Type: text/html; charset=UTF-8; Content-Transfer-Encoding: quoted-printable

<HTML><HEAD><TITLE>REM DISPATCH</TITLE></HEAD> <BODY>

<H1> <p> <font style="font-family: Arial; font-size: 05px; font-weight: 100; line-height:10px; text-align: left;"> <b>This is a REM dispatch</b><BR> </font> </p> </H1>


 Subject: Purchase order #1237<BR> The original message is attached.<BR> ... continue with the introduction HTML message here ...<BR>

</BODY> </HTML>

------=_Part_26335063_498347107.1481841694173-

------=_Part_26335064_533604049.1481841694172 Content-Type: message/rfc822; name=AttachedMimeMessage Content-Transfer-Encoding: binary Content-Disposition: attachment; filename=AttachedMimeMessage REM-Section-Type: rem_message/original

From: "Sender" <sender@s-rems.rem> To: <recipient@r-rems.rem> Subject: Purchase order #1237 Date: Tue, 16 Jan 2018 08:30:00 +0100 (CET) Message-ID: <00be01d30072$fde7b950$f9b72bf0$@de>

Bye

------=_Part_26335064_533604049.1481841694172 Content-Type: application/xml; name=submissionAcceptanceRejection.xml Content-Transfer-Encoding: quoted-printable Content-Disposition: attachment; filename=submissionAcceptanceRejection.xml REM-Section-Type: rem_message/evidence

<?xml version=3D"1.0" encoding=3D"UTF-8"?> <tns:Evidence xmlns:tns=3D"http://uri.etsi.org/19522/v1#" xmlns:xsi=3D"http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation=3D"http://www.etsi.org/evidence evidence.xsd "> tns:Evidence </tns:Evidence> ------=_Part_26335064_533604049.1481841694172 Content-Type: application/octet-stream; name="extension.dat" Content-Transfer-Encoding: quoted-printable Content-Disposition: attachment; filename="extension.dat" REM-Section-Type: rem_message/extension

0000000 54 68 69 73 20 69 73 20 61 20 73 69 6d 70 6c 65=0A= 0000010 20 65 78 74 65 6e 73 69 6f 6e 20 66 69 6c 65 20=0A= 0000020 66 6f 72 20 52 45 4d 0a =0A= 0000028=0A= ------=_Part_26335064_533604049.1481841694172-

------=_Part_26335066_750970089.1481841690001 Content-Type: application/pkcs7-signature; name=smime.p7s; smime-type=signed-data Content-Transfer-Encoding: base64 Content-Disposition: attachment; filename="smime.p7s" Content-Description: S/MIME Cryptographic Signature

VGhpcyBpcyBub3QgYSB2YWxpZCBTL01JTUUgc2lnbmF0dXJlIGJ1dCBvbmx5IGEg dmVyeSBzaW1wbGUgZW5jb2RlZCB0ZXh0LCB1c2VkIGFzIGFuIGV4YW1wbGUsIHdp aGluIHRoZSBSRU0gZGlzcGFjaCBtZXNzYWdlLgpBbnl3YXksIHRoZSByZWFkZXIg c2hvdWxkIGltbWFnaW5lIGhlcmUgYSB2YWxpZCBTL01JTUUgc2lnbmF0dXJlLCBt YWRlIHRocm91Z2ggYSB2YWxpZCBkaWdpdGFsIGNlcnRpZmljYXRlLCBhY2NvcmRp bmcgdG8gdGhlIHRlY2huaWNhbCBhbmQgbm9ybWF0aXZlIGNvbXBsaWFuY2UgcmVx dWlyZW1lbnRzLCBhc3NvY2lhdGVkIHRvIHRoZSAic2VydmljZSIgZW1haWwgYWRk cmVzczogInJlbS1zZXJ2aWNlQHMtcmVtcy5yZW0iLgoKVGhlIHB1cnBvc2Ugb2Yg dGhlIHByZXNlbnQgdGV4dCBpcyB0byBoYXZlIGEgdmVyeSBzbWFsbCBlbmNvZGVk IHRleHQgKGxpa2UgYSAiUy9NSU1FIHNpZ25hdHVyZSIpLCBhcyBhIHBsYWNlIGhv bGRlciB3aXRoaW4gdGhlIFJFTSBkaXNwYWN0aCBleGFtcGxlLCB0byB1c2UgaW4g UkVNIEVOIDUzMi0zIGRvY3VtZW50LgpBIHJlYWwgUy9NSU1FIHNpZ25hdHVyZSB3 YXMgbm90IG9wcG9ydHVuZSBpbiB0aGUgYWZvcmVtZW50aW9uZWQgZXhhbXBsZSBm b3IgdHdvIHJlYXNvbnM6CjEuIEl0IHdvdWxkIGJlIGEgdmVyeSBsb25nIChhcHBh cmVudGx5IGluc2lnbmlmaWNhbnQpIGFtb3VudCBvZiBieXRlcywgbm90IG5pY2Ug dG8gc2VlIGluIG9uZSBleGFtcGxlLCB3aXRoIHRoZSByaXNrIHRvIG92ZXJzaGFk b3csIGZvciB0aGlzLCBvdGhlciBpbXBvcnRhbnQgZmVhdHVyZXMgb2YgdGhlIGV4 YW1wbGUuCjIuIEl0IGlzIG5vdCBwb3NzaWJsZSB0byBoYXZlIGEgdmFsaWQgUy9N


SU1FIHNpZ25hdHVyZSwgd2l0aCBhIHZhbGlkIGRpZ2l0YWwgY2VydGlmaWNhdGUg KGkuZSByZWNvZ25pemVkIGluIG5vcm1hbCBlbWFpbCBjbGllbnRzIHdpdGhvdXQg YW55IG1hbnVhbCBpbXBvcnQgbm9yIG90aGVyIHRvIGRvIG1hbnVhbGx5KSwgZm9y IGEgImluZXhpc3RlbnQiIGVtYWlsIGFkZHJlc3MgbGlrZSB0aGF0IG9mIHRoZSBl eGFtcGxlOiAicmVtLXNlcnZpY2VAcy1yZW1zLnJlbSIuCg== ------=_Part_26335066_750970089.1481841690001-

 Figure A.4: Detailed REM dispatch example


## History

###### Document history

 V1.1.1 September 2018 Publication

 V1.1.3 January 2019 EN Approval Procedure AP 20190409: 2019-01-09 to 2019-04-09

 V1.2.1 April 2019 Publication
